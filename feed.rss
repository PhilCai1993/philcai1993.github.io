<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>NSObject</title><description></description><link>https://nsobject.app</link><language>zh</language><lastBuildDate>Sun, 19 Jun 2022 14:36:17 +0800</lastBuildDate><pubDate>Sun, 19 Jun 2022 14:36:17 +0800</pubDate><ttl>250</ttl><atom:link href="https://nsobject.app/feed.rss" rel="self" type="application/rss+xml"/><item><guid isPermaLink="true">https://nsobject.app/posts/exec%20ruby%20on%20ios</guid><title>åœ¨iOSä¸­è¿è¡ŒRuby(mruby ç®€ä»‹)</title><description>åœ¨iOSä¸­è¿è¡ŒRuby</description><link>https://nsobject.app/posts/exec%20ruby%20on%20ios</link><pubDate>Sun, 19 Jun 2022 13:18:00 +0800</pubDate><content:encoded><![CDATA[<h1>åœ¨iOSä¸­è¿è¡ŒRuby(mruby ç®€ä»‹)</h1><p>iOSä¸Šæ‰§è¡Œ<a href="https://developer.apple.com/documentation/javascriptcore">JS</a>ã€<a href="https://github.com/alibaba/LuaViewSDK">Lua</a>ã€<a href="https://bytekm.bytedance.net/kmf/articleDetail/391">Python</a>çš„æ¡ˆä¾‹å·²ç»å¾ˆå¤šäº†ï¼Œå¥½åƒå¾ˆå°‘æœ‰äººåˆ†äº«Rubyã€‚</p><p><a href="http://mruby.org/">mruby</a>æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºåµŒå…¥å¼è®¾è®¡çš„Ruby, ä½œè€…æ˜¯rubyçš„ä½œè€…(<a href="https://en.wikipedia.org/wiki/Yukihiro_Matsumoto">Matz</a>)æœ¬äºº. åœ¨å®ƒçš„<a href="https://github.com/mruby/mruby">GitHub</a>ä¸Šè¯´æ˜å®ƒæ”¯æŒRuby 1.9 çš„è¯­æ³•, å®é™…ä¸Š2.xçš„è¯­æ³•ä¹Ÿéƒ¨åˆ†æ”¯æŒ.</p><h2>è¯ç”ŸèƒŒæ™¯</h2><blockquote><p>æ‹¿å½“å‰çš„ Ruby (CRuby)æ¥è¯´, é¢„æƒ³çš„æ¶æ„æ˜¯â€ä½¿ç”¨ Ruby æ¥å¼€å‘åº”ç”¨ç¨‹åº. å¦‚æœé‡åˆ°ç¼ºå¤±çš„åŠŸèƒ½, å°±ä½¿ç”¨ C è¯­è¨€å¼€å‘æ‰©å±•ç¨‹åºåº“, ç„¶åæ·»åŠ åˆ° Ruby ä¸­â€. æ¢è¨€ä¹‹, ä»¥ä»å±å…³ç³»æ¥çœ‹, æ˜¯ Ruby ä¸ºä¸», C ä¸ºè¾…çš„å…³ç³». ç„¶è€Œ, è¿™ä¸åµŒå…¥å¼è½¯ä»¶ä¸­å¸¸è§çš„â€œä½¿ç”¨ C/C++ å¼€å‘ç¨‹åº, è€Œä»…æŠŠéœ€è¦çµæ´»æ€§æˆ–ç”Ÿäº§æ•ˆç‡çš„é‚£éƒ¨åˆ†äº¤ç»™ Rubyâ€çš„æ¶æ„ä¸ç¬¦.</p></blockquote><p>æ ¹æ®ä½œè€…çš„ä»‹ç», mruby æ˜¯ä¸€ä¸ªè½»é‡ã€æç®€çš„CRubyçš„å­é›†. å®šä½æ˜¯åµŒå…¥å¼, ä»¥C(C++/ObjC) ä¸ºä¸», mrubyä¸ºè¾…, è´Ÿè´£ä¸€äº›çµæ´»å¤šå˜çš„åŠŸèƒ½.</p><p>å’ŒåŒæ ·å¼ºå¤§çš„Luaç›¸æ¯”, Rubyå¼€å‘è€…çš„æ•°é‡æ›´å¤š(ä¸ªäººæ„Ÿè§‰Rubyå†™èµ·æ¥çˆ½ä¸€ç‚¹).</p><p>è‡³äºä¸ºä»€ä¹ˆç°åœ¨çœ‹èµ·æ¥è¿˜æ˜¯Lua/JS æ»¡å¤©é£, mruby å°‘æœ‰äººæâ€¦</p><img src="https://nsobject.app/Images/mruby_1.png"/><h2>mrubyç›®å½•ç»“æ„</h2><p>ä»¥ç›®å‰æœ€æ–°çš„<a href="http://mruby.org/releases/2019/04/04/mruby-2.0.1-released.html">mruby 2.0.1 released</a>ä¸ºä¾‹. <img src="https://nsobject.app/Images/mruby_2.png"/></p><ul><li>benchmark: æ€§èƒ½æµ‹è¯•</li><li>bin: mruby å®ç°çš„å‡ ä¸ªå·¥å…·<ul><li>mirb: ç›¸å½“äºæ—¥å¸¸ç”¨çš„ irb (Interactive Ruby)</li><li>mrbc: ç¼–è¯‘å™¨, å¯ä»¥å°†rubyä»£ç ç¼–è¯‘æˆä¸­é—´ä»£ç (.mrb æ ¼å¼)</li><li>mruby: ç›¸å½“äºruby command line</li><li>mruby-strip: å¤§æ¦‚æ˜¯ç”¨æ¥æ¸…é™¤rubyç¼–è¯‘äº§ç‰©çš„ç¬¦å·çš„</li><li>build: ç¼–è¯‘äº§ç‰©çš„è¾“å‡ºè·¯å¾„</li><li>examples: ä¸€äº›C &amp; mruby äº¤äº’çš„demo</li><li>include: å¤´æ–‡ä»¶</li><li>lib: ä¸€äº›mrubyçš„åŸºç¡€åŠŸèƒ½</li><li>mrbgems: åŒruby gems</li><li>mrblib: mruby çš„åŸºç¡€ç±»å‹çš„å£°æ˜æˆ–è€…å®ç°(ruby)</li><li>src: mrubyçš„æ ¸å¿ƒå®ç°(C)</li><li>tasks: toolchain(ä¸€å †rakefile)</li><li>test: æµ‹è¯•â€¦</li><li>minirake: ç²¾ç®€ç‰ˆrake</li><li>build_config.rb: ç±»ä¼¼CocoaPods çš„podspec, æè¿°å¦‚ä½•ç¼–è¯‘ä¸€ä¸ªå¯¹åº”å¹³å°çš„äºŒè¿›åˆ¶(æ¯”å¦‚å¯ä»¥åµŒå…¥åˆ°iOSçš„libmruby.a/MRuby.framework, Android å½“ç„¶ä¹Ÿå¯ä»¥)</li></ul></li></ul><h2>ç¼–è¯‘iOSé™æ€åº“(.a)</h2><p>å°† <em>build</em>config.rb* æ›¿æ¢ä¸ºå¦‚ä¸‹:</p><pre><code class="language-ruby">#build_config.rb
MRuby::Build.new do |conf|
  toolchain :clang
  conf.gembox "default"
end

def crossbuild(arch, ios_sdk, min_version = "8.0.0")
  MRuby::CrossBuild.new(arch) do |conf|
    toolchain :clang
    conf.gembox "default"
    conf.bins = []

    conf.cc do |cc|
      cc.command = "xcrun"
      cc.defines = ["MRB_INT64"] /#mrb_int ä½¿ç”¨ int64_t/
      cc.flags = %W(-sdk iphoneos clang -miphoneos-version-min=#{min_version} -arch #{arch} -isysroot #{ios_sdk} -fembed-bitcode)
    end

    conf.linker do |linker|
      linker.command = "xcrun"
      linker.flags = %W(-sdk iphoneos clang -miphoneos-version-min=#{min_version} -arch #{arch} -isysroot #{ios_sdk})
    end

    conf.build_mrbtest_lib_only
    conf.test_runner.command = "env"
  end
end

SIM_SDK_PATH = %x[xcrun --sdk iphonesimulator --show-sdk-path].strip
DEVICE_SDK_PATH = %x[xcrun --sdk iphoneos --show-sdk-path].strip
MIN_VERSION = "9.0.0"

#crossbuild

crossbuild("x86_64", SIM_SDK_PATH, MIN_VERSION)
crossbuild("arm64", DEVICE_SDK_PATH, MIN_VERSION)
crossbuild("armv7", DEVICE_SDK_PATH, MIN_VERSION)
# æœ‰éœ€è¦å¯ä»¥åŠ ä¸ªi386 çš„
</code></pre><p>ç„¶ååœ¨<em>build</em>config.rb<em> çš„ç›®å½•ä¸‹, æ‰§è¡Œ <code>./minirake</code>, å¦‚æœæ²¡é—®é¢˜ä¼šåœ¨buildç›®å½•ä¸‹ç”Ÿæˆ ä¸€ä¸ªhost ç›®å½•, ä»¥åŠx86</em>64 &amp; arm64 &amp; armv7 ç›®å½•(å¯¹åº”<code>CrossBuild</code>çš„å£°æ˜). åœ¨<code>$arch/lib</code>å¯ä»¥çœ‹åˆ°æœ‰<code>libmruby_core.a</code>,<code>libmruby.a</code>, lipo åˆå¹¶ä¸€ä¸‹, å¯ä»¥æ‹–åˆ°Xcode projectä½¿ç”¨(éœ€è¦ä¿®æ”¹ä¸€éƒ¨åˆ†include).</p><img src="https://nsobject.app/Images/mruby_3.png"/><h2>ç¼–è¯‘é™æ€framework</h2><p>ä¸ºäº†è®©Swiftä¹Ÿå¯ä»¥å’Œmruby äº¤äº’, éœ€è¦å°è¯•å°†ä¸Šé¢çš„<code>.a</code>æ‰“åŒ…æˆframework. åœ¨ä¸Šä¸€æ­¥çš„<code>minirake</code>æˆåŠŸå, å’Œ<em>build</em>config.rb<em>åŒä¸€çº§æ–°å»ºä¸€ä¸ª</em>build<em>framework.rb</em>.</p><pre><code class="language-ruby">#build_framework.rb
require "FileUtils"

SCRIPT_PATH = File.dirname(__FILE__)
BUILD_PATH = File.join(SCRIPT_PATH, "build")
FRAMEWORK_TARGET_PATH = File.join(BUILD_PATH, "MRuby.framework")
FRAMEWORK_HEADERS_DIR = File.join(FRAMEWORK_TARGET_PATH, "Headers")
SOURCE_HEADERS_DIR = File.join(SCRIPT_PATH, "include")
LIB_FILES = %w(x86_64 armv7 arm64).map do |arch|
    File.join(SCRIPT_PATH, "build", arch, "lib/libmruby.a")
end

FileUtils.rm_rf FRAMEWORK_TARGET_PATH
FileUtils.mkdir_p FRAMEWORK_HEADERS_DIR
FileUtils.cp_r "#{SOURCE_HEADERS_DIR}/mruby.h", "#{FRAMEWORK_HEADERS_DIR}/mruby_renamed.h"
FileUtils.cp_r "#{SOURCE_HEADERS_DIR}/mrbconf.h", FRAMEWORK_HEADERS_DIR
FileUtils.cp_r "#{SOURCE_HEADERS_DIR}/mruby/.", FRAMEWORK_HEADERS_DIR

Dir.glob("#{FRAMEWORK_HEADERS_DIR}/*.h").each do |file|
  replaced = File.read(file).gsub(/^#include "mruby\/(.+)"$/, '#include "\1"').gsub(/^#include &lt;mruby\.h&gt;$/, '#include "mruby_renamed.h"').gsub(/^#include &lt;mruby\/(.+)&gt;$/, '#include "\1"')
  File.open(file, "w") { |f| f.puts replaced }
end

File.open "#{FRAMEWORK_HEADERS_DIR}/MRuby.h", "w" do |file|
  file.puts "#define MRB_INT64"
  file.puts '#include "mruby_renamed.h"'
  Dir.chdir "#{FRAMEWORK_HEADERS_DIR}" do
    Dir["*.h"].each do |f|
      next if f == "mruby/debug.h"
      next if f == "boxing_nan.h"
      next if f == "boxing_no.h"
      next if f == "boxing_word.h"
      next if f == "ops.h"
      next if f == "opcode.h"
      next if f == "mruby_renamed.h"
      next if f == "mrbconf.h"
      next if f == "MRuby.h"
      file.puts "#include \"#{f}\""
    end
  end
end

Dir.mkdir "#{FRAMEWORK_TARGET_PATH}/Modules"
  File.open "#{FRAMEWORK_TARGET_PATH}/Modules/module.modulemap", "w" do |file|
    file.write &lt;&lt;EOF
framework module MRuby {
  umbrella header "MRuby.h"

  exclude header "boxing_nan.h"
  exclude header "boxing_no.h"
  exclude header "boxing_word.h"
  exclude header "debug.h"

  export *
  module * { export * }
}
EOF
end

system "lipo #{LIB_FILES.join " "} -create -output #{FRAMEWORK_TARGET_PATH}/MRuby"
</code></pre><p>è„šæœ¬çš„ä¸»è¦ä½œç”¨æ˜¯ 1. å°†<em>include</em>ç›®å½•ä¸‹çš„å„ä¸ª<code>.h</code>å¹³é“ºåˆ°åŒä¸€å±‚ 2. ä¿®æ­£ä¸€éƒ¨åˆ†<code>#include</code> 3. å°†åŸå…ˆçš„<em>mruby.h</em>é‡å‘½å, é˜²æ­¢å’Œæœ€ç»ˆçš„<em>MRuby.framework</em>å†²çª. 4. é…ç½®ä¸€ä¸‹<em>modulemap</em></p><p>æ‰§è¡Œ<code>./minirake &amp;&amp; ruby build_framework.rb</code>ä¹‹å, åœ¨<em>build</em> ç›®å½•ä¸‹å°±æœ‰ä¸€ä¸ª<em>MRuby.framework</em>.</p><img src="https://nsobject.app/Images/mruby_4.png"/><h2>å‚è€ƒ</h2><ul><li><a href="https://www.stephenw.cc/2017/08/23/llvm-modules/">LLVMçš„ Modules</a>.</li><li><a href="http://www.ituring.com.cn/book/1339">å…³äºmrubyçš„ä¸€åˆ‡</a></li><li><a href="https://github.com/stephenwzl/RubyCore">GitHub - stephenwzl/RubyCore: ruby core runtime wrapper for Objective-C &amp; CocoaTouch</a></li></ul>]]></content:encoded></item><item><guid isPermaLink="true">https://nsobject.app/posts/install%20chisel</guid><title>Install Chisel on macOS Mojave</title><description>Install Chisel on macOS Mojave</description><link>https://nsobject.app/posts/install%20chisel</link><pubDate>Tue, 9 Oct 2018 17:30:00 +0800</pubDate><content:encoded><![CDATA[<h1>Install Chisel on macOS Mojave</h1><p>æœ€è¿‘åˆšè·‘è·¯åˆ°æ–°å…¬å¸, æ‹¿åˆ°æ–°ç”µè„‘ä¹‹åè£…äº†macOS Mojave &amp; Xcode 10ä¹‹åå‡†å¤‡çœ‹ä»£ç , äºæ˜¯æƒ³ç”¨<a href="https://github.com/facebook/chisel">facebook/chisel</a> å¸®å¿™æ¥ç®€åŒ–ä¸€ä¸‹lldbçš„è°ƒè¯•. ç»“æœç”¨<code>brew install</code> ä¹‹å, å‡ºç°äº†compile error.</p><p>çœ‹çœ‹Logå°±çŸ¥é“æ˜¯Xcode 10 é»˜è®¤çš„ <code>New Build System</code>çš„é”…ğŸ˜….</p><p>é¡ºä¾¿çœ‹äº†ä¸€ä¸‹<a href="https://github.com/facebook/chisel/issues/249">issue</a>, æš‚æ—¶ä¹Ÿæ²¡è§£å†³è¯´æ˜¯<code>Homebrew</code>çš„é”…...</p><p>è¿˜ä¸å¦‚è‡ªç»™è‡ªè¶³, è§£å†³æ–¹æ³•è›®ç®€å•çš„:</p><p>è‡ªå·±forkä¸€ä»½chisel, ç„¶åç”¨Xcodeæ‰“å¼€<code>Chisel.xcodeproj</code>, é€‰File -&gt; Project Settings, æŠŠBuild System æ”¹æˆ<strong>Legacy Build System</strong>, ç„¶åæ¨åˆ°è‡ªå·±forkçš„ä»“åº“. åœ¨ä»“åº“é‡Œé€‰æ‹© Release -&gt; Draft a new release. copyä¸€ä¸‹<strong>Source code (tar.gz)</strong>çš„åœ°å€.</p><p>åœ¨æœ¬åœ°ä¿®æ”¹ä¸€ä¸‹ <code>usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/chisel.rb</code> (è¿™ä¸ªåœ°å€å¯ä»¥é€šè¿‡ <code>brew edit chisel</code> çœ‹åˆ°). å…¶ä¸­urlæ”¹æˆè‡ªå·±releaseçš„å‹ç¼©åŒ…åœ°å€, head æ”¹æˆè‡ªå·±çš„forkçš„ä»“åº“åœ°å€, sha256å¯ä»¥å…ˆä¸æ”¹.</p><p>è¿è¡Œä¸€ä¸‹</p><p><code>brew install --build-from-source /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/chisel.rb</code>, ä¼šæŠ¥é”™è¯´æ ¡éªŒå¤±è´¥å¹¶ä¸”ä¼šlogå‡ºä¸€ä¸ªæ­£ç¡®çš„hash, æŠŠè¿™ä¸ªrbæ–‡ä»¶é‡Œé¢çš„sha256æ”¹æˆlogé‡Œé¢çš„hash, å†è·‘ä¸€ä¸‹<code>brew install --build-from-source /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/chisel.rb</code>.</p><p>åº”è¯¥å°±å¯ä»¥äº†.</p><p>æ‡’å¾—çœ‹ğŸ‘†çš„å¯ä»¥ç›´æ¥æŠŠ</p><p><code>/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/chisel.rb</code> æ›¿æ¢æˆä¸‹é¢çš„ç„¶å <code>brew install chisel</code> (æ²¡æµ‹è¿‡åº”è¯¥å¯ä»¥ã€‚ã€‚ã€‚)</p><pre><code class="language-ruby">class Chisel &lt; Formula
  desc "Collection of LLDB commands to assist debugging iOS apps"
  homepage "https://github.com/facebook/chisel"
  url "https://github.com/PhilCai1993/chisel/archive/1.8.0.1.tar.gz"
  sha256 "0b64d26dff26cfd44110512fbea154f1dcd8f7703d764f165286cedf6ac3c268"
  head "https://github.com/PhilCai1993/chisel.git"

  bottle do
    cellar :any
    sha256 "eba994a5b5d1880890bab0db0741ec7f6c65f3cc4a78957355714a84b76f2fa2" =&gt; :high_sierra
    sha256 "0cde612e49ea07f54a455161b9371f6b662b450169947103dddba66fb2debe6c" =&gt; :sierra
    sha256 "82f135ec7770a425e666086b7a5d6a31b086c10e11df42fbe849354592f26a3e" =&gt; :el_capitan
  end

  def install
    libexec.install Dir["*.py", "commands"]
    prefix.install "PATENTS"

    # == LD_DYLIB_INSTALL_NAME Explanation ==
    # This make invocation calls xcodebuild, which in turn performs ad hoc code
    # signing. Note that ad hoc code signing does not need signing identities.
    # Brew will update binaries to ensure their internal paths are usable, but
    # modifying a code signed binary will invalidate the signature. To prevent
    # broken signing, this build specifies the target install name up front,
    # in which case brew doesn't perform its modifications.
    system "make", "-C", "Chisel", "install", "PREFIX=#{lib}", \
      "LD_DYLIB_INSTALL_NAME=#{opt_prefix}/lib/Chisel.framework/Chisel"
  end

  def caveats; &lt;&lt;~EOS
    Add the following line to ~/.lldbinit to load chisel when Xcode launches:
      command script import #{opt_libexec}/fblldb.py
  EOS
  end

  test do
    xcode_path = `xcode-select --print-path`.strip
    lldb_rel_path = "Contents/SharedFrameworks/LLDB.framework/Resources/Python"
    ENV["PYTHONPATH"] = "#{xcode_path}/../../#{lldb_rel_path}"
    system "python", "#{libexec}/fblldb.py"
  end
end

</code></pre><p>æœ€åé…ç½®ä¸€ä¸‹<code>.lldbinit</code>, å¸¸è§„æ“ä½œ.</p><p>æƒ³åæ§½çš„æ˜¯å¦‚æœæˆ‘çŸ¥é“æ€ä¹ˆè®©Xcodeé»˜è®¤éƒ½ä¸ç”¨New Build System å°±ä¸ç”¨æè¿™äº›äº†... è¿˜æ˜¯è‡ªå·±å¤ªèœğŸ”</p>]]></content:encoded></item><item><guid isPermaLink="true">https://nsobject.app/posts/UIKitDynamicsUIScrollView</guid><title>ç”¨UIKit Dynamicsæ¨¡ä»¿UIScrollView</title><description>ç”¨UIKit Dynamicsæ¨¡ä»¿UIScrollView</description><link>https://nsobject.app/posts/UIKitDynamicsUIScrollView</link><pubDate>Tue, 15 Mar 2016 12:00:00 +0800</pubDate><content:encoded><![CDATA[<h1>ç”¨UIKit Dynamicsæ¨¡ä»¿UIScrollView</h1><p>é¥¿äº†ä¹ˆåœ¨ä¸Šä¸ªç‰ˆæœ¬çš„æ—¶å€™å¯¹é¤å…é¡µåšäº†å¾ˆå¤§çš„æ”¹åŠ¨, æ— è®ºæ˜¯è§†è§‰ä¸Šè¿˜æ˜¯äº¤äº’ä¸Šéƒ½æœ‰å¾ˆä¸é”™çš„æ•ˆæœ. ä¸ºäº†å®ç°è¿™ç§æ•ˆæœ, æˆ‘ä»¬è‡ªå·±ç”¨UIPanGestureRecognizerå’ŒUIKit Dynamicsæ¨¡æ‹Ÿäº†ç³»ç»Ÿçš„UIScrollView, åŒ…æ‹¬æƒ¯æ€§æ»šåŠ¨, å¼¹æ€§, æ©¡çš®ç­‹(RubberBanding)æ•ˆæœ.</p><img src="https://nsobject.app/Images/UXRecord1.gif" alt="æ•ˆæœ1"/><p>åœ¨åˆšæ¥åˆ°è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™, æœ‰è¿‡å‡ ç§æƒ³æ³•:</p><ol><li>è¿™ä¸ªæ•ˆæœå¾ˆåƒæ˜¯UITableViewåŠ ä¸ŠHeaderçš„Parallelæ•ˆæœ</li><li>å¯ä»¥åœ¨ä¸€ä¸ªUIScrollViewä¸Šé¢åµŒå¥—ä¸€ä¸ªUITableViewä½œä¸ºå­è§†å›¾</li></ol><p>è¿™äº›æ–¹æ¡ˆéƒ½è¢«å¦å†³äº†. ç¬¬ä¸€ç§æ–¹æ¡ˆ, å› ä¸ºå½“å‰é¡µé¢ä¸ä»…æœ‰ä¸¤ä¸ªTableView(é£Ÿç‰©ç±»åˆ«å’Œèœå•), è€Œä¸”è¦æ”¯æŒå·¦å³æ»šåŠ¨åœ¨â€å•†å“â€, "è¯„ä»·â€, "è¯¦æƒ…â€ä¸‰ä¸ªé¡µé¢åˆ‡æ¢. ç”¨TableViewçš„headeråšè§†å·®æ•ˆæœæ˜¯ä¸å¤ªå¯èƒ½åšåˆ°çš„. å¯¹ç¬¬äºŒç§æ–¹æ¡ˆ, æ˜¯åœ¨<code>-[UIScrollViewDelegate scrollViewDidScroll:]</code>ä¸­å†æ‰‹åŠ¨ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªScrollViewçš„<code>contentOffset</code>, ä½¿å¾—å½“å‰çš„ä¸¤ä¸ªscrollViewçš„<code>contentOffset</code>éƒ½æ˜¯æ­£ç¡®çš„, ä½†æ˜¯éš¾ç‚¹æ˜¯å¾ˆéš¾å»æŒ‡å®šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨çš„æ—¶å€™, æ˜¯çˆ¶viewè¿˜æ˜¯å­viewçš„UIPanGestureRecognizeræ‰‹åŠ¿è¢«å“åº”. è€Œè€ƒè™‘å…ˆç¦ç”¨å…¶ä¸­çš„ä¸€ä¸ªæ‰‹åŠ¿(æ¯”å¦‚å­viewçš„), å…ˆè®©çˆ¶Viewçš„æ‰‹åŠ¿å¯ä»¥é©±åŠ¨çˆ¶Viewçš„<code>contentOffset</code>æ”¹å˜, ç›´åˆ°çˆ¶viewçš„<code>contentOffset</code>åˆ°äº†æŸä¸ªä½ç½®å†å¯ç”¨å­viewçš„æ‰‹åŠ¿, ç¦ç”¨çˆ¶viewçš„. è¿™å¸¦æ¥ä¸€ä¸ªé—®é¢˜, åœ¨åˆ‡æ¢æ‰‹åŠ¿çš„enableçš„æ—¶å€™, å³ä½¿æ‰‹æŒ‡æ²¡æœ‰ç¦»å¼€å±å¹•, ä½†æ˜¯æ‰‹åŠ¿å·²ç»ç¦ç”¨, å¯¼è‡´æ»šåŠ¨ä¸­æ–­, é™¤éæ‰‹æŒ‡ç¦»å¼€å±å¹•åé‡æ–°è§¦æ‘¸æ‰èƒ½å†æ¬¡æ»šåŠ¨, è¿™æ ·çš„æ•ˆæœæ¯”è¾ƒä¸æµç•…, å¹¶ä¸”å…¶ä¸­çš„é€»è¾‘æ¯”è¾ƒå¤æ‚, ä¸å¤ªå®¹æ˜“å¤„ç†. æˆ–è€…å­ç±»UIScrollViewå’ŒUITableView, åœ¨æ‰‹åŠ¿ä»£ç†<code>gestureRecognizer:shouldRecognizeSimultaneouslyWithGestureRecognizer</code> è¿”å›YES, ä½¿å¾—ä¸¤ä¸ªScrollViewå¯ä»¥åŒæ—¶æ»šåŠ¨, ç„¶ååœ¨<code>scrollViewDidScroll:</code>ä¸­è¿˜åŸå…¶ä¸­ä¸€ä¸ªScrollViewçš„contentOffset. ä½†æ˜¯è¿™æ ·å¯¼è‡´é€»è¾‘å˜å¾—å¤æ‚, å› ä¸ºè§†å›¾ä¸­çš„æ‰‹åŠ¿å¤ªå¤š. æŠŠScrollViewæ·»åŠ ä¸ºå¦ä¸€ä¸ªScrollViewçš„å­è§†å›¾å¹¶ä¸æ¨è.</p><p>æœ€å, è€ƒè™‘åˆ°è¿™ä¸ªæ•ˆæœè®¢åˆ¶ç¨‹åº¦å¾ˆé«˜, äºæ˜¯è‡ªå·±å»æ¨¡ä»¿ä¸€ä¸‹UIScrollViewçš„ç‰¹æ€§.</p><p>é¦–å…ˆè¯´æ˜ä¸€ä¸‹è§†å›¾çš„ç»“æ„:</p><pre><code>&lt;ParentViewController.View&gt;
   | &lt;Container&gt; //UIView
   |    | &lt;SegmentView&gt;
   |    | &lt;ScrollView&gt; //ä»…å·¦å³æ»‘åŠ¨(pagingEnabled)
   |    |    | &lt;ChildViewController1.View&gt;
   |    |    |    | &lt;CategoryListView&gt;
   |    |    |    | &lt;FoodListView&gt;
   |    |    | &lt;ChildViewController2.View&gt;
   |    |    |    | &lt;RatingListView&gt;
   |    |    | &lt;ChildViewController3.View&gt;
   |    |    |    | &lt;SummaryListView&gt;
</code></pre><p>ParentViewControllerå°±æ˜¯ä»é¦–é¡µPushè¿›å…¥çš„ViewController, åœ¨å®ƒçš„Viewä¸Šæ”¾ç½®äº†ä¸€ä¸ªContainer(ä¸€ä¸ªæ™®é€šçš„UIView), Containerçš„ä¸Šæ–¹æ˜¯SegmentView,ä¸‹æ–¹æ˜¯ä¸€ä¸ªå·¦å³æ»‘åŠ¨çš„ScrollView; åœ¨ScrollViewä¸Š, ä»å·¦å¾€å³æ”¾ç½®äº†ä¸‰ä¸ªViewControllerçš„View; æ‰€æœ‰çš„tableViewè§†å›¾çš„bounceéƒ½ç¦ç”¨. ç”±äºä½¿ç”¨äº†AutoLayout,</p><pre><code class="language-objc">  [Container mas_makeConstraints:^(MASConstraintMaker *make) {
	 make.left.right.bottom.equalTo(ParentViewController.View);     
	 make.top.equalTo(ParentViewController.View).offset(topOffset);
  }];
</code></pre><p>Containerçš„left, right, bottoméƒ½å¯¹åº”ParentViewController.Viewçš„left,right,bottom, æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹topOffsetå¯¹åº”çš„çº¦æŸ, å°±å¯ä»¥åšå‡ºå¦‚ä¸‹çš„æ•ˆæœ:</p><img src="https://nsobject.app/Images/UXRecord2.gif" alt="æ•ˆæœ2"/><p>ä¸ºäº†è®©äº¤äº’çš„æ‰€æœ‰ç»†èŠ‚éƒ½å¯æ§, æˆ‘ä»¬è¦æŠŠFoodListView, RatingListView, SummaryListViewçš„scrollEnabledè®¾ç½®ä¸ºNO, ä¹Ÿå°±æ˜¯å°†UIScrollViewè‡ªå¸¦çš„panGestureRecognizerç¦ç”¨, ç„¶ååœ¨Containerä¸ŠåŠ ä¸Šè‡ªå·±çš„PanGestureRecognizer. è¿™æ ·ä¹‹ååªè¦æ˜¯å’Œä¸Šä¸‹æ»šåŠ¨ç›¸å…³çš„äº¤äº’(tableViewçš„æ»šåŠ¨å’ŒContainerçš„topçš„çº¦æŸ)éƒ½ç”±è‡ªå·±å®ç°çš„PanGestureRecognizerå®Œæˆ. è¿™ä¹ˆåšæœ‰ä¸¤ç‚¹ä¼˜åŠ¿, ä¸€æ˜¯å½“åœ¨ä¸Šä¸‹æ»‘åŠ¨çš„æ—¶å€™PanGestureRecognizerä¸€å®šä¼šè§¦å‘, å¹¶ä¸”åœ¨æ»‘åŠ¨çš„æ—¶å€™, å¯ä»¥ç²¾ç¡®çš„æ§åˆ¶å½“å‰æ‰‹åŠ¿çš„ä½ç§»æ˜¯ä¿®æ”¹Containerçš„é¡¶éƒ¨çº¦æŸè¿˜æ˜¯ä¿®æ”¹å½“å‰é¡µé¢çš„tableViewçš„contentOffset; äºŒæ˜¯åœ¨æ‰‹åŠ¿ç»“æŸçš„æ—¶å€™, å¯ä»¥è·å–æœ€åæ‰‹åŠ¿çš„é€Ÿåº¦<code>-[UIPanGestureRecognizer velocityInView:]</code> è¿™æ–¹ä¾¿äº†ä¹‹åæ¨¡æ‹Ÿæƒ¯æ€§æ•ˆæœ.</p><p>åœ¨æ¨¡æ‹ŸScrollViewçš„ä¸‰ä¸ªç‰¹æ€§é‡Œé¢, æœ€ç®€å•çš„æ˜¯RubberBanding(æ©¡çš®ç­‹æ•ˆæœ), æƒ¯æ€§æ»šåŠ¨å’Œå¼¹æ€§åŸç†æ˜¯ç±»ä¼¼çš„.</p><h1>RubberBanding</h1><p>å› ä¸ºåªå¯ç”¨äº†è‡ªå®šä¹‰çš„panæ‰‹åŠ¿, åœ¨æ™®é€šæƒ…å†µä¸‹, è¦ä¿®æ”¹tableViewçš„contentOffset æˆ–è€…ä¿®æ”¹Containerçš„é¡¶éƒ¨çº¦æŸ, åªéœ€è¦åœ¨<code>pan.state == UIGestureRecognizerStateChanged</code>, æ ¹æ®<code>[pan translationInView: Container].y</code>è·å–å‚ç›´æ–¹å‘çš„æ‰‹åŠ¿ä½ç§», ä¿®æ”¹contentOffsetæˆ–è€…çº¦æŸçš„å˜åŒ–ç­‰äºæ‰‹åŠ¿ä½ç§». è‡³äºRubberBanding, åœ¨å‚ç›´æ–¹å‘ä¸Šæœ‰ä¸¤ç§å¯èƒ½: Containerè·ç¦»é¡¶éƒ¨è¶…è¿‡æŸä¸ªé¢„è®¾çš„å€¼, æ‰‹åŠ¿ç»§ç»­å‘ä¸‹æ‹–åŠ¨; æˆ–è€…tableViewçš„æ‹‰åˆ°åº•éƒ¨ä¹‹åæ‰‹åŠ¿ç»§ç»­å‘ä¸Š. è¿™ä¸ªæ—¶å€™ä¿®æ”¹<code>contentOffset</code>æˆ–è€…é¡¶éƒ¨çº¦æŸçš„å˜åŒ–å°äºæ‰‹åŠ¿ä½ç§»(æ¯”å¦‚ä¹˜ä»¥ä¸€ä¸ªå°äº1çš„å› æ•°), å°±å¯ä»¥æ¨¡ä»¿å‡ºRubberBandingæ•ˆæœ.</p><h1>æƒ¯æ€§ &amp; å¼¹æ€§</h1><p>è¿™é‡Œè¯´çš„æƒ¯æ€§æ•ˆæœä¸ä»…åŒ…æ‹¬æ¨¡ä»¿tableViewè‡ªèº«çš„æƒ¯æ€§å‡é€Ÿä¿®æ”¹<code>contentOffset</code>. è¿˜åŒ…æ‹¬: <em> åœ¨æ‰‹åŠ¿ç»“æŸä¹‹å, Containeræ ¹æ®æƒ¯æ€§çš„æ•ˆæœåŠ¨æ€æ”¹å˜å®ƒçš„é¡¶éƒ¨çº¦æŸ. </em> ContaineræŒ‰ç…§æƒ¯æ€§æ•ˆæœåˆ°é¡¶éƒ¨å(topçº¦æŸå‡å°, Containerå‘ä¸Šç§»åŠ¨), æƒ¯æ€§æ•ˆæœæ²¡æœ‰æ¶ˆå¤±, ç»§ç»­é©±åŠ¨tableViewçš„<code>contentOffset</code>ä¿®æ”¹. (é€Ÿåº¦ä¼ é€’) * tableViewæŒ‰ç…§æƒ¯æ€§å‡å°<code>contentOffset.y</code>åˆ°0å, æƒ¯æ€§æ•ˆæœç»§ç»­é©±åŠ¨Containerä¿®æ”¹é¡¶éƒ¨çº¦æŸ. (é€Ÿåº¦ä¼ é€’) åŒæ ·, å¼¹æ€§æ•ˆæœä¹Ÿä¸åªæ˜¯tableViewåˆ°è¾¾è¶…è¿‡åº•éƒ¨ä¹‹åæ”¾æ‰‹å›å¼¹, ä¹ŸåŒ…æ‹¬Containerè·ç¦»é¡¶éƒ¨è¶…è¿‡ä¸€å®šè·ç¦»ä¹‹åæ”¾æ‰‹å›å¼¹æ•ˆæœ, ä»¥åŠå¯èƒ½å› ä¸ºé€Ÿåº¦ä¼ é€’åå¯¼è‡´çš„å›å¼¹.</p><p>å…ˆç®€å•çš„è€ƒè™‘åªåœ¨æ‰‹åŠ¿ç»“æŸåå‘ç”Ÿçš„æƒ¯æ€§å’Œå¼¹æ€§, å¾ˆå¹¸è¿çš„æ˜¯å¯ä»¥è·å–æ‰‹åŠ¿æœ€åä¸€åˆ»çš„é€Ÿåº¦<code>[pan velocityInView:Container].y</code>. ç¬¬ä¸€ååº”æ˜¯ä½¿ç”¨UIViewçš„springAnimation, å› ä¸ºå®ƒæ¥å—ä¼ å…¥é€Ÿåº¦. ä½†æ˜¯å…¶ä»–å‚æ•°æ¯”å¦‚duration, å…¶å®æ²¡æœ‰å¤ªå¥½çš„æ–¹æ¡ˆå»æŒ‡å®š, å¦‚æœåŠ ä¸Šé€Ÿåº¦ä¼ é€’çš„æ•ˆæœ, å®ƒå°±æ›´æ— èƒ½ä¸ºåŠ›äº†. åå¤æ»‘åŠ¨ç³»ç»Ÿçš„ScrollView, åœ¨è°ƒç”¨æ ˆå‘ç°å®ƒæ˜¯ç”±CADisplayLinké©±åŠ¨çš„, å‘ç°å®ƒçš„è¡Œä¸ºå’ŒUIKit Dynamicsçš„åŠ¨ç”»å¾ˆç¬¦åˆ, è€Œä¸”UIKit DynamicsèƒŒåä¹Ÿæ˜¯CADisplayLink,åŠ ä¸ŠUIDynamicBehavioræœ‰ä¸ªactionå±æ€§:</p><pre><code class="language-When running, the dynamic animator calls the action block on every animation step.```">
åœ¨æ¯ä¸€å¸§åŠ¨ç”»çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨ä¸‹. è¿™äº›ç»„åˆèµ·æ¥, è¶³å¤Ÿå»æ¨¡æ‹ŸScrollViewçš„å„ç§è¡Œä¸ºäº†.

ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨UIKit Dynamicsçš„æ—¶å€™, æˆ‘ä»¬æ˜¯æŠŠå„ç§Behaviourç›´æ¥æ·»åŠ åˆ°UIViewä¸Š, ç„¶åè§†å›¾å°±ä¼šåœ¨å®ƒåˆ°ä½œç”¨ä¸‹åŠ¨èµ·æ¥. ä½†åœ¨ç°åœ¨çš„æƒ…å†µä¸‹, å¹¶ä¸èƒ½å¤Ÿç›´æ¥å¯¹è§†å›¾æ·»åŠ Behaviour. ç”±äºBehaviourå®é™…æ˜¯å¯¹éµå¾ªUIDynamicItemåè®®çš„å¯¹è±¡åšç‰©ç†åŠ¨ç”», æ‰€ä»¥å¯ä»¥æŠŠcontentOffsetæˆ–è€…é¡¶éƒ¨çº¦æŸçš„å€¼åšä¸€å±‚æŠ½è±¡. 

</code></pre><p>objc @interface DynamicItem : NSObject<UIDynamicItem>
@property (nonatomic, readwrite) CGPoint center;
@property (nonatomic, readonly) CGRect bounds;
@property (nonatomic, readwrite) CGAffineTransform transform;
@end

@implementation DynamicItem
- (instancetype)init {
  if (self = [super init]) {
	_bounds = CGRectMake(0, 0, 1, 1);
  }
  return self;
}
@end

```

DynamicItemçš„å®ä¾‹å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè´¨ç‚¹, åœ¨å‚ç›´æ–¹å‘ä¸Š, å®ƒçš„ä½ç½®(center)å¯ä»¥ç”¨æ¥ä»£è¡¨Containerçš„ä½ç½®(top), ä¹Ÿå¯ä»¥ç”¨æ¥ä»£è¡¨tableViewçš„`contentOffset.y`, å®ƒçš„`transform`å±æ€§å¯ä»¥ä¸ç”¨è€ƒè™‘. 

æ— è®ºæ˜¯ä¿®æ”¹Containerçš„ä½ç½®è¿˜æ˜¯tableViewçš„`contentOffset`, åœ¨æƒ¯æ€§æˆ–å¼¹æ€§æ•ˆæœçš„æƒ…å†µä¸‹, åªè¦åœ¨actionä¸­å°†çº¦æŸçš„å€¼æˆ–è€…`contentOffset.y`è®¾ç½®ä¸ºDynamicItemçš„`center.y`å°±å¯ä»¥. UIKit Dynamicsè‡ªå·±ä¼šåœ¨æ¯ä¸€å¸§å»ä¿®æ”¹.

æ¯”å¦‚æƒ¯æ€§æ•ˆæœä¸‹ä¿®æ”¹Containerçš„é¡¶éƒ¨çº¦æŸå¤§æ¦‚æ˜¯è¿™æ ·çš„:

```objc
// when pan.state == UIGestureRecognizerStateEnded
NVMDynamicItem *item = [NVMDynamicItem new];
// topOffsetè¡¨ç¤ºå½“å‰Containerè·ç¦»é¡¶éƒ¨çš„è·ç¦»
item.center = CGPointMake(0, topOffset);
// velocityæ˜¯åœ¨æ‰‹åŠ¿ç»“æŸçš„æ—¶å€™è·å–çš„ç«–ç›´æ–¹å‘çš„æ‰‹åŠ¿é€Ÿåº¦
UIDynamicItemBehavior *inertialBehavior = [[UIDynamicItemBehavior alloc] initWithItems:@[ item ]];
  [inertialBehavior addLinearVelocity:CGPointMake(0, velocity) forItem:item];
  // é€šè¿‡å°è¯•å–2.0æ¯”è¾ƒåƒç³»ç»Ÿçš„æ•ˆæœ
  inertialBehavior.resistance = 2.0; 
  inertialBehavior.action = ^{
    CGFloat itemTop = item.center.y;
    [Container mas_updateConstraints:^(MASConstraintMaker *make) {
      make.top.equalTo(ParentViewController.View).offset(itemTop);
  }];
};
[self.animator addBehavior:inertialBehavior];

```

ç±»ä¼¼çš„å¼¹æ€§æ•ˆæœåªéœ€ä½¿ç”¨UIAttachmentBehaviorå¹¶ä¸”è®¾ç½®åˆé€‚çš„å€¼, å°è¯•ä¸‹æ¥length = 0, damping = 1, frequency = 1.6, å°±æœ‰ä¸é”™çš„å›å¼¹æ•ˆæœ.
ä¿®æ”¹contentOffsetä¹Ÿæ˜¯ç±»ä¼¼, åªä¸è¿‡æ˜¯å°†åœ¨actionä¸­ä¿®æ”¹çº¦æŸçš„éƒ¨åˆ†æ”¹ä¸ºä¿®æ”¹contentOffset.

å¯¹äºé€Ÿåº¦ä¼ é€’, å®Œå…¨ä¸€æ ·çš„åŸç†, å”¯ä¸€çš„å˜åŒ–å°±æ˜¯ä»è·å–æ‰‹åŠ¿çš„é€Ÿåº¦å˜ä¸ºè·å–`-[UIDynamicItemBehavior linearVelocityForItem]`çš„çº¿é€Ÿåº¦, ç„¶åUIDynamicAnimatorç§»é™¤ä¸éœ€è¦çš„åŠ¨ç”», æŒ‰ç…§ä¸Šé¢çš„ä¾‹å­ä¼ å…¥é€Ÿåº¦å†æ¬¡åšæƒ¯æ€§åŠ¨ç”». 

ç”šè‡³è¿˜å¯ä»¥æŠŠUIAttachmentBehaviorå’ŒUIDynamicItemBehavioråŒæ—¶ä½¿ç”¨, æ¨¡ä»¿æœ‰åˆé€Ÿåº¦çš„å›å¼¹æ•ˆæœ.

å¤§è‡´çš„æ€è·¯å°±æ˜¯è¿™æ ·, åªéœ€è¦æ³¨æ„ä»€ä¹ˆæ—¶å€™è°ƒç”¨`-[UIDynamicAnimator removeBehavior]`åœæ­¢åŠ¨ç”»(æ¯”å¦‚æ‰‹åŠ¿åˆšå¼€å§‹çš„æ—¶å€™), ä»¥åŠactionä¸­æ³¨æ„retain cycle.

æœ‰ä¸ª2014å¹´çš„[åšå®¢](http://holko.pl/2014/07/06/inertia-bouncing-rubber-banding-uikit-dynamics/)å·²ç»æœ‰äº†ç±»ä¼¼çš„ä¾‹å­, åªæ˜¯äº¤äº’ç®€å•ä¸€äº›, åŸç†æ˜¯ä¸€æ ·çš„.

è€Œåœ¨è¿ç”¨è‡ªå·±çš„æ‰‹åŠ¿å»å®ç°ScrollViewä¹‹å, ç¢°åˆ°äº†ä¸€äº›ç»†èŠ‚é—®é¢˜.

1. è‡ªå·±åŠ åˆ°Containerä¸Šçš„æ‰‹åŠ¿, å¾ˆå®¹æ˜“è¯¯è§¦å‘tableViewçš„`-tableView:didSelectRowAtIndexPath:indexPath`åè®®æ–¹æ³•, å¯¼è‡´å¾ˆå®¹æ˜“Pushåˆ°ä¸‹ä¸€ä¸ªé¡µé¢, å¾ˆå½±å“ä½¿ç”¨. è§£å†³çš„åŸç†æ¯”è¾ƒç®€å•, åœ¨åˆé€‚çš„æ—¶æœºå°†å½“å‰çš„tableView.userInteractionEnabledè®¾ç½®ä¸ºNO, ä¹‹ååœ¨éœ€è¦çš„æ—¶å€™æ¢å¤. æ­£å¥½UIDynamicAnimatorDelegateæä¾›äº†åŠ¨ç”»å°†è¦å¼€å§‹`dynamicAnimatorWillResume:`å’Œæš‚åœ(åŒ…æ‹¬ç§»é™¤bahaviour)`dynamicAnimatorDidPause:`çš„å›è°ƒ. å°±åœ¨è¿™ä¸¤ä¸ªåœ°æ–¹åˆ†åˆ«è®¾ç½®, æ•ˆæœè¿˜å¯ä»¥æ¥å—.
2. å½“tableViewåœ¨UIKit Dynamicsçš„ä½œç”¨ä¸‹æ»šåŠ¨æ—¶, æˆ–è€…æ˜¯å¿«é€Ÿä¸Šä¸‹æ»‘åŠ¨çš„æ—¶å€™, å¾ˆå®¹æ˜“è§¦å‘å·¦å³æ»‘åŠ¨çš„ScrollViewåˆ‡æ¢é¡µé¢. è§£å†³æ–¹æ¡ˆæ¯”è¾ƒtricky: è‡ªå®šä¹‰äº†UIScrollViewçš„å­ç±», åœ¨å­ç±»ä¸­å°†gestureRecognizerShouldBegin:é‡å†™, å¯¹äºpanGestureRecognizerçš„æƒ…å†µ, åœ¨å®ƒçš„æ°´å¹³é€Ÿåº¦å’Œå‚ç›´é€Ÿåº¦çš„å¤¹è§’åœ¨ä¸€å®šèŒƒå›´å†…å¼ºåˆ¶è¿”å›NO. è¿™æ ·å°±å¤§å¤§å‡å°äº†è¯¯è§¦å‘å·¦å³æ»šåŠ¨çš„æ“ä½œ. ä½†æ˜¯è¿˜æ˜¯å¸Œæœ›æœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ.
3. è¿˜æœ‰ä¸€ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜, ç‚¹å‡»çŠ¶æ€æ , æ­£å¸¸æƒ…å†µä¸‹ç³»ç»Ÿèƒ½å¤Ÿå°†ScrollViewæ»šåŠ¨åˆ°é¡¶éƒ¨, è€Œåœ¨ä¸€ä¸ªWindowä¸­æœ‰å¤šä¸ªScrollViewçš„æ—¶å€™, å®ƒæ˜¯ä¸ä¸€å®šæˆåŠŸçš„. æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯å°†å½“å‰é¡µé¢éœ€è¦å“åº”ç³»ç»ŸstatusBarç‚¹å‡»çš„ScrollViewçš„`scrollsToTop`è®¾ç½®ä¸ºYES, å…¶ä»–éƒ½è®¾ç½®ä¸ºNO, å¹¶ä¸”`scrollsToTop`ä¸ºYESçš„åªèƒ½æœ‰ä¸€ä¸ª, è¿™ç§æƒ…å†µä¸‹ç†è®ºä¸Šæ˜¯å¯ä»¥workçš„. ä½†æ˜¯åœ¨è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™, å¯¼è‡´äº†è¿™ç§è§£å†³æ–¹æ³•æœ‰æ—¶å€™ä¸æˆåŠŸ. å› ä¸ºå‘ç°åœ¨ä¸€ä¸ªUIScrollViewçš„`userInteractionEnabled == NO`çš„æ—¶å€™, çŠ¶æ€æ ç‚¹å‡»è¿”å›é¡¶éƒ¨æ•ˆæœæ˜¯æ— æ•ˆçš„(æ¯”å¦‚æ­£åœ¨æƒ¯æ€§æ»šåŠ¨çš„æ—¶å€™, çŠ¶æ€è¿˜æ˜¯NO, è¿™ä¸ªæ—¶å€™ç‚¹å‡»statusBar); åŠ ä¸Šåœ¨æœ€å·¦è¾¹çš„é¡µé¢æœ‰ä¸¤ä¸ªtableViewéœ€è¦åŒæ—¶æ»šåŠ¨åˆ°é¡¶éƒ¨. åªèƒ½æ¢ä¸ªè§£å†³æ–¹æ¡ˆ. å­ç±»åŒ–äº†å…¨å±€çš„UIWindow, é‡å†™å®ƒçš„`-pointInside:withEvent:`, åœ¨statusBaråŒºåŸŸè¢«ç‚¹å‡»çš„æ—¶å€™å‘å‡ºé€šçŸ¥, ç›‘å¬åˆ°åæ‰‹åŠ¨è®¾ç½®contentOffsetåˆ°0. 
4. ç”±äºä¹‹å‰å¾ˆå¤šæ§ä»¶æ˜¯AutoLayoutå†™çš„, æ¯”å¦‚cell, å› ä¸ºç°åœ¨å®ç°çš„æ–¹æ¡ˆä¼šé¢‘ç¹ä¿®æ”¹çº¦æŸ, å¯¼è‡´æ»‘åŠ¨å¾ˆå¡(ä¹‹å‰åœ¨iPhone 6å°±æ„Ÿå—åˆ°å¡é¡¿äº†). ä¹‹åç”¨æ‰‹åŠ¨å¸ƒå±€æ”¹äº†ä¸€éƒ¨åˆ†cell, ç¡®å®æµç•…äº†å¾ˆå¤š.


è™½ç„¶UIKit Dynamicså¹³æ—¶å¾ˆå°‘ç”¨åˆ°, ä¸è¿‡åœ¨å…³é”®æ—¶åˆ»ä¹Ÿå‘æŒ¥äº†å·¨å¤§çš„ä½œç”¨, å¾ˆå¥½å¥‡Appleåœ¨å®ç°UIScrollViewä¼šä¸ä¼šä¹Ÿç”¨åˆ°äº†å®ƒ.
</p>]]></content:encoded></item></channel></rss>